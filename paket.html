<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paket - UNNES STUDY ZONE</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="shortcut icon" href="icon.png" type="image/x-icon">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
    
    body {
      font-family: 'Poppins', sans-serif;
      scroll-behavior: smooth;
      padding-top: var(--navbar-height, 90px); /* Adjust for fixed navbar */
    }
    nav {
        font-family: 'Inter', sans-serif;
    }
    nav#navbar {
      height: var(--navbar-height, 90px);
    }
    
    /* Modern gradient backgrounds */
    .bg-gradient-blue {
      background: linear-gradient(135deg, #4F46E5 0%, #2563EB 100%);
    }
    
    .bg-gradient-card {
      background: linear-gradient(135deg, #ffffff 0%, #f3f4f6 100%);
    }

    /* Initial gradient for the navbar from new.html */
    .bg-gradient-hero-nav {
      background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 35%, #7c3aed 100%);
    }
    
    /* Custom animations */
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    
    .animate-float {
      animation: float 3s ease-in-out infinite;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .animate-gradient {
      background-size: 200% 200%;
      animation: gradientShift 5s ease infinite;
    }
    
    /* Modern card hover effects */
    .card-hover {
      transition: all 0.3s ease;
    }
    
    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    /* Loading spinner animation */
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-spinner {
      animation: spin 1s linear infinite;
    }
    
    /* Toast notification animation */
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    .toast {
      animation: slideIn 0.3s ease-out forwards;
    }
    
    /* Scroll progress indicator */
    .progress-bar {
      height: 3px;
      background: #3b82f6;
      width: 0%;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 9999;
      transition: width 0.2s ease;
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #3b82f6;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #2563eb;
    }
    
    /* Back-to-top button */
    .back-to-top {
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    
    .back-to-top.hidden {
      opacity: 0;
      transform: translateY(20px);
    }
    
    /* Selected package border */
    .package-card.selected {
      border: 3px solid #2563eb; /* blue-700 */
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    /* Navbar scrolled state (from akun.html) */
    nav#navbar.scrolled {
      background: rgba(15, 23, 42, 0.9); /* bg-slate-900 with higher opacity */
      backdrop-filter: blur(10px);
    }

    /* Selected payment method button */
    .select-method.selected {
        border-color: #2563eb; /* blue-700 */
        background-color: #dbeafe; /* blue-100 */
    }

    /* NEW badge specific styles */
    .new-badge {
        position: absolute;
        top: 0;
        left: 0;
        background-color: #ef4444; /* red-500 */
        color: white;
        padding: 0.25rem 0.75rem;
        border-bottom-right-radius: 0.5rem;
        font-size: 0.75rem; /* text-xs */
        font-weight: bold;
        text-transform: uppercase;
        transform: translateY(-100%); /* Hide initially above the card */
        animation: slideDownBadge 0.5s ease-out forwards;
        z-index: 10; /* Ensure it's above other elements */
    }

    @keyframes slideDownBadge {
        from { transform: translateY(-100%); }
        to { transform: translateY(0); }
    }
  </style>
</head>
<body class="bg-gray-50">
  <!-- Progress bar for scroll indicator -->
  <div class="progress-bar" id="scrollProgress"></div>

  <!-- Loading spinner -->
  <div id="loading" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full loading-spinner"></div>
  </div>
  
  <!-- Toast notification -->
  <div id="toast" class="fixed bottom-5 right-5 text-white p-4 rounded-lg shadow-lg z-50 hidden toast">
    <div class="flex items-center">
      <i class="fas mr-2"></i>
      <span id="toastMessage"></span>
    </div>
  </div>

  <!-- Payment Confirmation Modal -->
  <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg p-6 max-w-md w-full card-hover" data-aos="zoom-in">
      <h3 class="text-xl font-bold text-gray-800 mb-4">Konfirmasi Pembayaran</h3>
      <p class="text-gray-600 mb-4">Anda akan membeli paket <span id="modalPackage">Belum dipilih</span>.</p>
      <p class="text-gray-600 mb-6">Nominal: <span id="modalAmount">Rp 0</span></p>
      <h4 class="text-md font-semibold text-gray-800 mb-3">Pilih Metode Pembayaran</h4>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 mb-4">
            <!-- These are the payment method selection buttons, now only in modal -->
            <button data-method="Transfer Bank" class="select-method bg-gray-100 p-3 rounded-lg text-gray-800 hover:bg-blue-100 transition-all flex items-center justify-center text-sm border border-gray-200">
            <i class="fas fa-university mr-2"></i> Transfer
            </button>
            <button data-method="QRIS" class="select-method bg-gray-100 p-3 rounded-lg text-gray-800 hover:bg-blue-100 transition-all flex items-center justify-center">
            <i class="fas fa-qrcode mr-2"></i> QRIS
            </button>
            <button data-method="E-Wallet" class="select-method bg-gray-100 p-3 rounded-lg text-gray-800 hover:bg-blue-100 transition-all flex items-center justify-center text-sm border border-gray-200">
            <i class="fas fa-wallet mr-2"></i> E-Wallet
            </button>
        </div>
        <p id="methodInstruction" class="text-gray-600 text-center text-sm mb-6 hidden">Metode terpilih: <span id="selectedMethodInModal" class="font-semibold text-blue-600"></span></p>

      <div class="flex justify-end gap-4">
        <button id="cancelPayment" class="bg-gray-300 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-400 transition-all">Batal</button>
        <button id="confirmPayment" class="bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-all disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>Bayar Sekarang</button>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="fixed top-0 w-full z-50 transition-all duration-300 bg-gradient-hero-nav text-white shadow-lg" id="navbar">
    <div class="container mx-auto px-4">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-yellow-300 rounded-lg flex items-center justify-center mr-3 shadow-lg">
                <img src="logo.png" alt="Logo" class="w-8 h-8">
            </div>
            <a href="index.html" class="text-3xl font-extrabold text-white hover:opacity-80 transition-opacity">UNNES</a>
            <a href="index.html" class="text-3xl font-medium text-blue-200 hover:opacity-80 transition-opacity">STUDY ZONE</a>
        </div>
        
        <!-- Desktop Menu -->
        <div class="hidden md:flex items-center space-x-6">
          <a href="index.html" class="hover:text-blue-200 transition-colors duration-200 flex items-center">
            <i class="fas fa-home mr-1"></i> Home
          </a>
          <a href="tryout.html" class="hover:text-blue-200 transition-colors duration-200 flex items-center">
            <i class="fas fa-file-alt mr-1"></i> Tryout
          </a>
          <a href="materi.html" class="hover:text-blue-200 transition-colors duration-200 flex items-center">
            <i class="fas fa-book mr-1"></i> Materi
          </a>
          <a href="paket.html" class="text-yellow-300 transition-colors duration-200 flex items-center">
            <i class="fas fa-credit-card mr-1"></i> Paket
          </a>
          <a href="akun.html" class="hover:text-blue-200 transition-colors duration-200 flex items-center">
            <i class="fas fa-user-circle mr-1"></i> Akun
          </a>
          <div class="border-l pl-4 border-blue-400">
            <a href="login.html" class="hover:text-blue-200 transition-colors duration-200 mr-4">
              <i class="fas fa-sign-in-alt mr-1"></i> Login
            </a>
            <a href="register.html" class="bg-yellow-400 text-blue-900 py-2 px-4 rounded-lg font-medium hover:bg-yellow-300 transition-all">
              <i class="fas fa-user-plus mr-1"></i> Sign Up
            </a>
          </div>
        </div>
        
        <!-- Mobile menu button -->
        <div class="md:hidden">
          <button id="menuBtn" class="text-white focus:outline-none">
            <i class="fas fa-bars text-xl"></i>
          </button>
        </div>
      </div>
      
      <!-- Mobile Menu -->
      <div id="mobileMenu" class="md:hidden hidden mobile-menu pb-4">
        <div class="flex flex-col space-y-3">
          <a href="index.html" class="hover:bg-blue-700 py-2 px-4 rounded-md transition-colors">
            <i class="fas fa-home mr-2"></i> Home
          </a>
          <a href="tryout.html" class="hover:bg-blue-700 py-2 px-4 rounded-md transition-colors">
            <i class="fas fa-file-alt mr-2"></i> Tryout
          </a>
          <a href="materi.html" class="hover:bg-blue-700 py-2 px-4 rounded-md transition-colors">
            <i class="fas fa-book mr-2"></i> Materi
          </a>
          <a href="paket.html" class="bg-blue-700 py-2 px-4 rounded-md transition-colors">
            <i class="fas fa-credit-card mr-2"></i> Paket
          </a>
          <a href="akun.html" class="hover:bg-blue-700 py-2 px-4 rounded-md transition-colors">
            <i class="fas fa-user-circle mr-2"></i> Akun
          </a>
          <div class="pt-2 border-t border-blue-400 flex flex-col space-y-2">
            <a href="login.html" class="bg-blue-700 py-2 px-4 rounded-md text-center transition-colors">
              <i class="fas fa-sign-in-alt mr-2"></i> Login
            </a>
            <a href="register.html" class="bg-yellow-400 text-blue-900 py-2 px-4 rounded-md text-center font-medium">
              <i class="fas fa-user-plus mr-2"></i> Sign Up
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="bg-gradient-blue animate-gradient text-white py-16 relative overflow-hidden">
    <div class="absolute inset-0 overflow-hidden">
      <div class="absolute -top-20 -left-20 w-40 h-40 bg-blue-400 rounded-full opacity-10"></div>
      <div class="absolute top-20 right-20 w-60 h-60 bg-blue-300 rounded-full opacity-10 animate-float"></div>
      <div class="absolute bottom-10 left-1/3 w-40 h-40 bg-indigo-400 rounded-full opacity-10" style="animation: float 4s ease-in-out infinite;"></div>
    </div>
    
    <div class="container mx-auto px-4 relative z-10 text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-4" data-aos="fade-up">Pilih Paket Belajar Anda</h1>
      <p class="text-lg mb-8 text-blue-100 max-w-2xl mx-auto" data-aos="fade-up" data-aos-delay="100">Dapatkan akses tak terbatas ke semua fitur kami dengan paket berlangganan.</p>
    </div>
  </section>

  <!-- Packages Section -->
  <section id="packages" class="py-16 bg-gray-100">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-800" data-aos="fade-up">Pilih Paket Sesuai Kebutuhanmu</h2>
        <p class="text-gray-600 mt-2 max-w-2xl mx-auto" data-aos="fade-up" data-aos-delay="100">Berbagai pilihan paket dengan fitur yang disesuaikan untuk kebutuhan belajarmu</p>
      </div>
      
      <div id="packagesContainer" class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <!-- Packages will be dynamically loaded here -->
      </div>
    </div>
  </section>

  <!-- Payment Summary Section -->
  <div class="py-16 bg-gray-100 pt-0"> <!-- Added pt-0 to avoid double padding -->
    <div class="container mx-auto px-4">
      <div class="mt-12 p-6 bg-white rounded-lg shadow-md max-w-lg mx-auto" data-aos="fade-up" data-aos-delay="400">
        <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">Ringkasan Pembelian</h3>
        <div class="flex justify-between items-center mb-3">
          <span class="text-gray-700">Paket Terpilih:</span>
          <span id="selectedPackageName" class="font-semibold text-gray-900">Belum Ada</span>
        </div>
        <div class="flex justify-between items-center mb-3 hidden" id="originalPriceRow">
            <span class="text-gray-700">Harga Asli:</span>
            <span id="originalPriceDisplay" class="font-semibold text-gray-900">Rp 0</span>
        </div>
        <div class="flex justify-between items-center mb-3 hidden" id="discountRow">
            <span class="text-gray-700">Diskon (<span id="discountPercentage">0%</span>):</span>
            <span id="discountAmount" class="font-semibold text-red-500">- Rp 0</span>
        </div>
        <div class="flex justify-between items-center mb-3">
          <span class="text-gray-700">Metode Pembayaran:</span>
          <span id="selectedMethodDisplay" class="font-semibold text-gray-900">Akan dipilih di langkah selanjutnya</span>
        </div>
        
        <!-- Promo Code Input Section -->
        <div class="mb-4 mt-6">
            <label for="promoCodeInput" class="block text-gray-700 text-sm font-bold mb-2">Kode Promo (Opsional):</label>
            <div class="flex gap-2">
                <input type="text" id="promoCodeInput" placeholder="Masukkan kode promo" class="flex-grow shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                <button id="applyPromoBtn" class="bg-blue-500 text-white py-2 px-4 rounded-lg font-semibold hover:bg-blue-600 transition-colors">Terapkan</button>
            </div>
            <p id="promoMessage" class="text-sm mt-1"></p>
        </div>

        <div class="border-t border-gray-200 pt-4 mt-4 flex justify-between items-center">
          <span class="text-lg font-bold text-gray-800">Total Pembayaran:</span>
          <span id="totalPaymentDisplay" class="text-2xl font-bold text-blue-600">Rp 0</span>
        </div>
        <button id="payNowBtn" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all mt-6 disabled:bg-gray-400 disabled:cursor-not-allowed">
          Lanjutkan Pembayaran
        </button>
      </div>
    </div>
  </div>


  <!-- Footer -->
  <footer class="bg-gray-900 text-white pt-16 pb-8">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-12">
        <div>
          <div class="flex items-center mb-6">
            <div class="w-10 h-10 bg-yellow-300 rounded-lg flex items-center justify-center mr-3 shadow-lg">
                <img src="logo.png" alt="Logo" class="w-8 h-8">
            </div>
            <span class="text-xl font-bold">UNNES STUDY ZONE</span>
          </div>
          <p class="text-gray-400 mb-4">
            Platform persiapan UTS & UAS Online #1 di Indonesia untuk mahasiswa.
          </p>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
              <i class="fab fa-instagram text-xl"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
              <i class="fab fa-twitter text-xl"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
              <i class="fab fa-facebook-f text-xl"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
              <i class="fab fa-youtube text-xl"></i>
            </a>
          </div>
        </div>
        
        <div>
          <h3 class="text-lg font-semibold mb-6">Menu</h3>
          <ul class="space-y-3">
            <li><a href="index.html" class="text-gray-400 hover:text-white transition-colors duration-300">Home</a></li>
            <li><a href="index.html#features" class="text-gray-400 hover:text-white transition-colors duration-300">Features</a></li>
            <li><a href="index.html#subjects" class="text-gray-400 hover:text-white transition-colors duration-300">Subjects</a></li>
            <li><a href="index.html#packages" class="text-gray-400 hover:text-white transition-colors duration-300">Packages</a></li>
            <li><a href="login.html" class="text-gray-400 hover:text-white transition-colors duration-300">Account</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-lg font-semibold mb-6">Bantuan</h3>
          <ul class="space-y-3">
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">FAQ</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Kontak Kami</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Kebijakan Privasi</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">Syarat & Ketentuan</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-lg font-semibold mb-6">Kontak</h3>
          <ul class="space-y-3 text-gray-400">
            <li class="flex items-start">
              <i class="fas fa-map-marker-alt mt-1 mr-3"></i>
              <span>Jl. Pendidikan No. 1, Semarang, Jawa Tengah</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-envelope mt-1 mr-3"></i>
              <span>hello@unnesstudyzone.com</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-phone-alt mt-1 mr-3"></i>
              <span>(024) 1234 5678</span>
            </li>
            <li class="flex items-start">
              <i class="fab fa-whatsapp mt-1 mr-3"></i>
              <span>+62 812 3456 7890</span>
            </li>
          </ul>
        </div>
      </div>
      
      <div class="border-t border-gray-800 pt-8 text-center text-gray-500">
        <p>© 2025 UNNES STUDY ZONE. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Back-to-Top Button -->
  <button id="backToTop" class="fixed bottom-5 right-5 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-all back-to-top hidden">
    <i class="fas fa-arrow-up"></i>
  </button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script>
    // Initialize AOS
    AOS.init({ duration: 800, once: true });

    // --- Global Utility Functions ---
    function showElement(element) { if (element) element.classList.remove('hidden'); }
    function hideElement(element) { if (element) element.classList.add('hidden'); }
    function showToastNotification(message, type = 'success') {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      const toastIcon = toast.querySelector('i');

      toastMessage.textContent = message;
      toast.classList.remove('bg-green-500', 'bg-red-500', 'bg-blue-500'); // Clear all types
      toastIcon.classList.remove('fa-check-circle', 'fa-times-circle', 'fa-info-circle');

      if (type === 'success') {
        toast.classList.add('bg-green-500');
        toastIcon.classList.add('fa-check-circle');
      } else if (type === 'error') {
        toast.classList.add('bg-red-500');
        toastIcon.classList.add('fa-times-circle');
      } else if (type === 'info') {
        toast.classList.add('bg-blue-500');
        toastIcon.classList.add('fa-info-circle');
      }
      
      showElement(toast);
      setTimeout(() => { hideElement(toast); }, 3000);
    }

    // --- Data for Packages ---
    const packagesData = {
        'basic_tryout': {
            id: 'basic_tryout',
            name: 'BASIC',
            type: 'Kursus Singkat',
            price: 5000,
            duration: '1x Tryout',
            accessModel: 'one-time',
            features: [
                { text: 'Akses 1x Tryout untuk 1 Mata Kuliah', icon: 'check', color: 'green' },
                { text: 'Pembahasan Soal Dasar', icon: 'check', color: 'green' },
                { text: 'Hasil Nilai Standar', icon: 'check', color: 'green' },
                { text: 'Analisis Performa', icon: 'times', color: 'red' },
                { text: 'Materi Pembelajaran', icon: 'times', color: 'red' }
            ],
            isPopular: false,
            isNew: false,
            previewText: 'Pratinjau: Akses 5 soal tryout gratis dan pendahuluan singkat.',
            contentAccessPage: 'tryout.html' // Example: direct to tryout page for 1x access
        },
        'premium_monthly': {
            id: 'premium_monthly',
            name: 'PREMIUM',
            type: 'Langganan Bulanan',
            price: 15000,
            duration: '1 Bulan',
            accessModel: 'subscription',
            features: [
                { text: 'Akses ke Semua Tryout', icon: 'check', color: 'green' },
                { text: 'Pembahasan Soal Lengkap', icon: 'check', color: 'green' },
                { text: 'Analisis Performa Detail', icon: 'check', color: 'green' },
                { text: 'Akses Materi Pembelajaran', icon: 'check', color: 'green' },
                { text: 'Prioritas Dukungan Pelanggan', icon: 'check', color: 'green' }
            ],
            isPopular: true,
            isNew: false,
            previewText: 'Pratinjau: Video intro & bab pertama dari berbagai materi.',
            contentAccessPage: 'akun.html' // Dashboard to access all
        },
        'group_bundle': {
            id: 'group_bundle',
            name: 'GROUP',
            type: 'Bundle Kursus',
            price: 20000,
            duration: '1x Tryout (5 orang)',
            accessModel: 'one-time',
            features: [
                { text: 'Akses 1x Tryout untuk 5 Orang', icon: 'check', color: 'green' },
                { text: 'Pembahasan Soal Dasar', icon: 'check', color: 'green' },
                { text: 'Hasil Nilai Standar', icon: 'check', color: 'green' },
                { text: 'Diskon untuk Kelompok', icon: 'check', color: 'green' },
                { text: 'Analisis Performa', icon: 'times', color: 'red' }
            ],
            isPopular: false,
            isNew: false,
            previewText: 'Pratinjau: Video singkat tentang manfaat belajar kelompok.',
            contentAccessPage: 'tryout.html' // Example: direct to tryout for group
        },
        'sertifikasi_digital': {
            id: 'sertifikasi_digital',
            name: 'Program Sertifikasi Digital',
            type: 'Sertifikasi',
            price: 150000,
            duration: 'Lifetime Access',
            accessModel: 'one-time',
            features: [
                { text: 'Akses Penuh Modul Sertifikasi', icon: 'check', color: 'green' },
                { text: 'Ujian Akhir & Sertifikat Resmi', icon: 'check', color: 'green' },
                { text: 'Dukungan Mentor Eksklusif', icon: 'check', color: 'green' },
                { text: 'Workshop Tambahan', icon: 'check', color: 'green' }
            ],
            isPopular: false,
            isNew: true, // Set to true for 'NEW' badge
            previewText: 'Pratinjau: Video perkenalan program sertifikasi & silabus.',
            contentAccessPage: 'akun.html'
        }
    };

    const promoCodes = {
        'UNNESDISKON20': {
            type: 'percentage',
            value: 0.20, // 20% off
            appliesTo: ['premium_monthly', 'sertifikasi_digital', 'group_bundle'], // Specific packages
            expiryDate: new Date('2025-12-31'),
            usageLimit: 100 // Example: only 100 uses
        },
        'STUDYZONEHEMAT50': {
            type: 'percentage',
            value: 0.50, // 50% off
            appliesTo: ['basic_tryout', 'premium_monthly', 'group_bundle'], // Specific packages
            expiryDate: new Date('2025-07-31'),
            usageLimit: 50
        }
    };

    // --- DOM Elements ---
    const menuBtn = document.getElementById('menuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const scrollProgress = document.getElementById('scrollProgress');
    const backToTop = document.getElementById('backToTop');
    const loadingScreen = document.getElementById('loading');
    const navbar = document.getElementById('navbar');

    const packagesContainer = document.getElementById('packagesContainer');
    const selectedPackageNameDisplay = document.getElementById('selectedPackageName');
    const originalPriceRow = document.getElementById('originalPriceRow');
    const originalPriceDisplay = document.getElementById('originalPriceDisplay');
    const discountRow = document.getElementById('discountRow');
    const discountPercentageDisplay = document.getElementById('discountPercentage');
    const discountAmountDisplay = document.getElementById('discountAmount');
    const selectedMethodDisplay = document.getElementById('selectedMethodDisplay'); // New element for selected method in summary
    const totalPaymentDisplay = document.getElementById('totalPaymentDisplay');
    const payNowBtn = document.getElementById('payNowBtn');

    const paymentModal = document.getElementById('paymentModal');
    const modalPackage = document.getElementById('modalPackage');
    const modalMethod = document.getElementById('modalMethod'); // Modal's display for selected method
    const modalAmount = document.getElementById('modalAmount');
    const modalSelectMethods = document.querySelectorAll('.select-method'); // Specific selector for modal buttons
    const cancelPayment = document.getElementById('cancelPayment');
    const confirmPayment = document.getElementById('confirmPayment');
    const selectedMethodInModal = document.getElementById('selectedMethodInModal'); // Span inside modal for method name
    const methodInstruction = document.getElementById('methodInstruction'); // Instruction text below modal method selection
    
    // Promo elements in main page summary
    const promoCodeInput = document.getElementById('promoCodeInput');
    const applyPromoBtn = document.getElementById('applyPromoBtn');
    const promoMessage = document.getElementById('promoMessage');


    let currentSelectedPackageId = null;
    let currentOriginalPrice = 0;
    let currentDiscountedPrice = 0;
    let currentSelectedMethod = null; // Stores selected method from modal for final processing
    let currentAppliedPromoCode = ''; // Stores the code string of the applied promo


    // --- Functions ---

    // Render Packages Dynamically
    function renderPackages() {
        packagesContainer.innerHTML = ''; // Clear existing
        for (const key in packagesData) {
            const pkg = packagesData[key];
            const isPopularClass = pkg.isPopular ? 'relative transform scale-105' : '';
            const popularBadge = pkg.isPopular ? `
                <div class="absolute top-0 right-0 bg-yellow-400 text-blue-900 px-4 py-1 rounded-bl-lg font-medium">
                    TERPOPULER
                </div>
            ` : '';
            const newBadge = pkg.isNew ? `
                <div class="new-badge">BARU</div>
            ` : ''; // New badge HTML

            const headerBg = pkg.isPopular ? 'bg-blue-600 text-white' : 'bg-blue-100 text-blue-800';
            const headerText = pkg.isPopular ? 'text-white' : 'text-blue-800';

            let featureListHtml = '';
            pkg.features.forEach(feature => {
                featureListHtml += `
                    <li class="flex items-start">
                        <i class="fas fa-${feature.icon}-circle text-${feature.color}-500 mt-1 mr-2"></i>
                        <span>${feature.text}</span>
                    </li>
                `;
            });

            const packageCard = document.createElement('div');
            packageCard.className = `package-card bg-white rounded-xl shadow-lg overflow-hidden card-hover relative ${isPopularClass}`; // Added relative for absolute positioning of badges
            packageCard.setAttribute('data-aos', 'fade-up');
            packageCard.setAttribute('data-aos-delay', pkg.isPopular || pkg.isNew ? '200' : '100'); // Stagger delay

            packageCard.innerHTML = `
                ${popularBadge}
                ${newBadge} <!-- Add new badge here -->
                <div class="${headerBg} p-6 text-center">
                    <h3 class="text-2xl font-bold ${headerText}">${pkg.name}</h3>
                    <p class="${pkg.isPopular ? 'text-blue-100' : 'text-blue-600'}">${pkg.type}</p>
                </div>
                <div class="p-8">
                    <div class="flex justify-center items-end mb-6">
                        <span class="text-3xl font-bold text-gray-800">Rp ${pkg.price.toLocaleString('id-ID')}</span>
                        <span class="text-gray-500 ml-1">/${pkg.duration.toLowerCase().includes('tryout') ? 'tryout' : pkg.duration.toLowerCase().includes('bulan') ? 'bulan' : 'akses'}</span>
                    </div>
                    <ul class="space-y-3 mb-8">
                        ${featureListHtml}
                    </ul>
                    <button class="select-package w-full bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition-all transform hover:scale-105 flex items-center justify-center" data-package-id="${pkg.id}">
                        <i class="fas fa-check-circle mr-2"></i> Pilih Paket
                    </button>
                    <button class="view-preview-btn w-full mt-3 text-blue-600 border border-blue-600 py-2 rounded-lg font-semibold hover:bg-blue-50 transition-all flex items-center justify-center" data-preview-text="${pkg.previewText}">
                        <i class="fas fa-eye mr-2"></i> Lihat Pratinjau
                    </button>
                </div>
            `;
            packagesContainer.appendChild(packageCard);
        }
        

        // Re-attach event listeners after rendering
        document.querySelectorAll('.select-package').forEach(button => {
            button.addEventListener('click', handlePackageSelect);
        });
        document.querySelectorAll('.view-preview-btn').forEach(button => {
            button.addEventListener('click', handleViewPreview);
        });
    }

    // Handle Package Selection
    function handlePackageSelect(event) {
        // Remove 'selected' style from all package cards and buttons
        document.querySelectorAll('.package-card').forEach(card => card.classList.remove('selected'));
        document.querySelectorAll('.select-package').forEach(btn => {
            btn.classList.remove('bg-yellow-400', 'text-blue-900');
            btn.classList.add('bg-blue-600', 'text-white');
        });

        // Add 'selected' style to the clicked card and button
        const clickedCard = event.target.closest('.package-card');
        clickedCard.classList.add('selected');
        event.target.classList.add('bg-yellow-400', 'text-blue-900');
        event.target.classList.remove('bg-blue-600', 'text-white');


        currentSelectedPackageId = event.target.dataset.packageId;
        const pkg = packagesData[currentSelectedPackageId];
        currentOriginalPrice = pkg.price;
        currentDiscountedPrice = pkg.price; // Reset discounted price on new package selection
        currentAppliedPromoCode = ''; // Clear applied promo
        promoCodeInput.value = ''; // Clear promo input
        promoMessage.textContent = ''; // Clear promo message

        selectedPackageNameDisplay.textContent = pkg.name;
        selectedMethodDisplay.textContent = 'Akan dipilih di langkah selanjutnya'; // Reset method display on main summary
        
        updateMainPageSummary(); // Update the summary section, which now also enables the button
    }

    // Handle View Preview
    function handleViewPreview(event) {
        const previewText = event.target.dataset.previewText;
        showToastNotification(previewText, 'info'); // Using toast for simple preview simulation
        // In a real app, this would open a specific preview modal or redirect
    }

    // Update Main Page Payment Summary
    function updateMainPageSummary() {
        if (!currentSelectedPackageId) {
            selectedPackageNameDisplay.textContent = 'Belum Ada';
            originalPriceDisplay.textContent = 'Rp 0';
            totalPaymentDisplay.textContent = 'Rp 0';
            hideElement(originalPriceRow);
            hideElement(discountRow);
            payNowBtn.disabled = true; // Disabled if no package
            selectedMethodDisplay.textContent = 'Akan dipilih di langkah selanjutnya'; // Ensure this is also reset
            return;
        }

        // If a package is selected, enable the button
        payNowBtn.disabled = false; // <<< FIX: Explicitly enable the button here

        selectedPackageNameDisplay.textContent = packagesData[currentSelectedPackageId].name;
        originalPriceDisplay.textContent = `Rp ${currentOriginalPrice.toLocaleString('id-ID')}`;
        showElement(originalPriceRow);

        totalPaymentDisplay.textContent = `Rp ${currentDiscountedPrice.toLocaleString('id-ID')}`;
        
        if (appliedDiscount > 0) {
            discountAmountDisplay.textContent = `- Rp ${appliedDiscount.toLocaleString('id-ID')}`;
            const percentage = (appliedDiscount / currentOriginalPrice * 100).toFixed(0);
            discountPercentageDisplay.textContent = `${percentage}%`;
            showElement(discountRow);
        } else {
            hideElement(discountRow);
        }
    }


    // Apply Promo Code
    function applyPromoCode() {
        const inputCode = promoCodeInput.value.trim().toUpperCase();
        const promo = promoCodes[inputCode];
        promoMessage.textContent = ''; // Clear previous message
        appliedDiscount = 0; // Reset any previously applied discount

        if (!currentSelectedPackageId) {
            showToastNotification('Pilih paket terlebih dahulu sebelum menerapkan kode promo.', 'info');
            return;
        }

        const selectedPackage = packagesData[currentSelectedPackageId];

        if (promo) {
            const today = new Date();
            if (today > promo.expiryDate) {
                promoMessage.textContent = 'Kode promo sudah kedaluwarsa.';
                promoMessage.classList.add('text-red-500');
                currentAppliedPromoCode = '';
                updateMainPageSummary();
                return;
            }
            
            if (promo.appliesTo && !promo.appliesTo.includes(selectedPackage.id)) {
                promoMessage.textContent = `Kode promo tidak berlaku untuk paket ${selectedPackage.name}.`;
                promoMessage.classList.add('text-red-500');
                currentAppliedPromoCode = '';
                updateMainPageSummary();
                return;
            }

            if (promo.type === 'percentage') {
                appliedDiscount = Math.round(currentOriginalPrice * promo.value);
            } else if (promo.type === 'fixed') {
                appliedDiscount = promo.value;
            }
            currentDiscountedPrice = Math.max(0, currentOriginalPrice - appliedDiscount); // Price cannot be negative

            promoMessage.textContent = `Kode promo ${inputCode} berhasil diterapkan!`;
            promoMessage.classList.remove('text-red-500');
            promoMessage.classList.add('text-green-500');
            currentAppliedPromoCode = inputCode; 
        } else if (inputCode === '') {
            promoMessage.textContent = 'Tidak ada kode promo diterapkan.';
            promoMessage.classList.remove('text-green-500', 'text-red-500');
            currentAppliedPromoCode = '';
        } else {
            promoMessage.textContent = 'Kode promo tidak valid atau tidak ditemukan.';
            promoMessage.classList.remove('text-green-500');
            promoMessage.classList.add('text-red-500');
            currentAppliedPromoCode = '';
        }
        updateMainPageSummary(); // Update the displayed prices in summary
    }

    // Handle Payment Method Selection inside MODAL
    function handleModalMethodSelect(event) {
        modalSelectMethods.forEach(btn => {
            btn.classList.remove('selected');
        });
        event.target.classList.add('selected');
        currentSelectedMethod = event.target.dataset.method; // Set global variable
        selectedMethodInModal.textContent = currentSelectedMethod; // Update display in modal
        showElement(methodInstruction); // Show instruction if hidden
        confirmPayment.disabled = false; // Enable confirm button in modal
    }


    // Simulate Payment Process (initiated from modal)
    function simulatePayment() {
        // This is the payment process after user confirms in the modal
        // Hide modal first
        hideElement(paymentModal);

        showToastNotification('Memproses pembayaran...', 'info');

        // Simulate successful transaction
        setTimeout(() => {
            const purchasedPackages = JSON.parse(localStorage.getItem('purchasedPackages') || '[]');
            const packageInfo = packagesData[currentSelectedPackageId];
            const purchaseDate = new Date().toLocaleDateString('id-ID', { day: '2-digit', month: '2-digit', year: 'numeric' }); // dd/mm/yyyy

            let expiryDate = 'Lifetime';
            if (packageInfo.duration.includes('Bulan')) {
                const months = parseInt(packageInfo.duration.split(' ')[0]);
                const exp = new Date();
                exp.setMonth(exp.getMonth() + months);
                expiryDate = exp.toLocaleDateString('id-ID', { day: '2-digit', month: '2-digit', year: 'numeric' });
            } else if (packageInfo.duration.includes('Tahun')) {
                const years = parseInt(packageInfo.duration.split(' ')[0]);
                const exp = new Date();
                exp.setFullYear(exp.getFullYear() + years);
                expiryDate = exp.toLocaleDateString('id-ID', { day: '2-digit', month: '2-digit', year: 'numeric' });
            }

            purchasedPackages.push({
                packageId: currentSelectedPackageId,
                name: packageInfo.name,
                price: currentDiscountedPrice, // Save discounted price
                originalPrice: currentOriginalPrice, // Save original price
                appliedPromo: currentAppliedPromoCode, // Save applied promo code
                selectedMethod: currentSelectedMethod, // Save selected payment method
                purchaseDate: purchaseDate,
                expiryDate: expiryDate,
                accessModel: packageInfo.accessModel,
                contentAccessPage: packageInfo.contentAccessPage 
            });
            localStorage.setItem('purchasedPackages', JSON.stringify(purchasedPackages));
            
            showToastNotification('Pembayaran berhasil! Anda akan diarahkan ke halaman akun.', 'success');
            
            // Clear selections after successful purchase
            currentSelectedPackageId = null;
            currentOriginalPrice = 0;
            currentDiscountedPrice = 0;
            currentSelectedMethod = null; // Clear selected method
            currentAppliedPromoCode = '';
            promoCodeInput.value = '';
            promoMessage.textContent = '';
            updateMainPageSummary(); // Reset summary display
            selectedMethodDisplay.textContent = 'Akan dipilih di langkah selanjutnya'; // Reset main summary method display

            // Also reset package and method selections visually
            modalSelectMethods.forEach(btn => btn.classList.remove('selected'));
            document.querySelectorAll('.package-card').forEach(card => card.classList.remove('selected'));
            document.querySelectorAll('.select-package').forEach(btn => {
                btn.classList.remove('bg-yellow-400', 'text-blue-900');
                btn.classList.add('bg-blue-600', 'text-white');
            });


            setTimeout(() => {
                window.location.href = 'akun.html'; // Redirect to account page
            }, 2000);
        }, 2000); // Simulate 2-second payment processing
    }


    // --- Event Listeners ---
    document.addEventListener('DOMContentLoaded', () => {
        // Render packages on page load
        renderPackages();

        // Mobile menu toggle
        if (menuBtn && mobileMenu) {
            menuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
                menuBtn.querySelector('i').classList.toggle('fa-bars');
                menuBtn.querySelector('i').classList.toggle('fa-times');
            });
        }

        // Scroll progress bar
        window.addEventListener('scroll', () => {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollPercent = (docHeight > 0) ? (scrollTop / docHeight) * 100 : 0;
            scrollProgress.style.width = scrollPercent + '%';
        });

        // Back-to-top button
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                backToTop.classList.remove('hidden');
            } else {
                backToTop.classList.add('hidden');
            }
        });
        backToTop.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Navbar scroll effect
        window.addEventListener('scroll', () => {
            if (window.scrollY > 100) {
                navbar.classList.add('scrolled', 'shadow-lg');
            } else {
                navbar.classList.remove('scrolled', 'shadow-lg');
            }
        });

        // Attach event listeners for payment methods inside the MODAL
        modalSelectMethods.forEach(button => {
            button.addEventListener('click', handleModalMethodSelect);
        });

        // Pay Now Button (opens modal)
        if (payNowBtn) {
            payNowBtn.addEventListener('click', () => {
                if (currentSelectedPackageId) { // Only package needs to be selected to open modal
                    modalPackage.textContent = packagesData[currentSelectedPackageId].name;
                    modalAmount.textContent = `Rp ${currentDiscountedPrice.toLocaleString('id-ID')}`;
                    
                    // Reset modal payment method state
                    modalSelectMethods.forEach(btn => btn.classList.remove('selected'));
                    currentSelectedMethod = null; // Clear selected method from previous modal open/selection
                    selectedMethodInModal.textContent = 'Belum dipilih'; // Reset display
                    hideElement(methodInstruction); // Hide instruction until method is selected in modal
                    confirmPayment.disabled = true; // Disable confirm button until method selected in modal

                    showElement(paymentModal);
                } else {
                    showToastNotification('Pilih paket terlebih dahulu.', 'error');
                }
            });
        }

        // Cancel Payment
        if (cancelPayment) {
            cancelPayment.addEventListener('click', () => {
                hideElement(paymentModal);
            });
        }

        // Confirm Payment (simulated)
        if (confirmPayment) {
            confirmPayment.addEventListener('click', simulatePayment);
        }

        // Apply Promo Button event listener
        if (applyPromoBtn) {
            applyPromoBtn.addEventListener('click', applyPromoCode);
        }

        // Allow pressing Enter key in promo code input to apply
        if (promoCodeInput) {
            promoCodeInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault(); // Prevent form submission
                    applyPromoCode();
                }
            });
        }

        // Show loading spinner on page transition
        document.querySelectorAll('a[href]').forEach(link => {
            link.addEventListener('click', (e) => {
                const href = link.getAttribute('href');
                if (href && !href.startsWith('#') && !href.includes('whatsapp') && !link.href.includes('instagram') && !link.href.includes('twitter') && !link.href.includes('facebook') && !link.href.includes('youtube')) {
                    if (loadingScreen) {
                        loadingScreen.classList.remove('hidden');
                    }
                }
            });
        });
        
        // Initial summary update
        updateMainPageSummary();
    });
  </script>
</body>
</html>
